<%= javascript_include_tag "uploadify/swfobject", "uploadify/jquery.uploadify.v2.1.4.min" %>
<script type="text/javascript" charset="utf-8">
$(document).ready(function() {
	
	$('#picture_photo').click(function(event){ 
		event.preventDefault();
	}); 
	
<% session_key_name = Rails.application.config.session_options[:key] %>
	  $('#picture_photo').uploadify({
	      uploader   	  : '/javascripts/uploadify/uploadify.swf',
		  cancelImg  	  : '/images/cancel.png',
		  multi      	  : true,
		  script     	  : '/pictures',
	      fileDesc        : 'Photo',
	      fileExt         : '*.png;*.jpg;*.gif',
	      sizeLimit       : <%= 1.megabytes %>,
	      buttonText      : 'Upload',
	      scriptData      : {
	        '_http_accept': 'application/javascript',
	        '_method': 'post',
	        '<%= session_key_name %>' : encodeURIComponent('<%= u cookies[session_key_name] %>'),
	        'authenticity_token': encodeURIComponent('<%= u form_authenticity_token %>'),
			'user_id' : '<%= current_user.id %>'
	      }
	  });

	$('#picture_submit').click(function(event){ 
			event.preventDefault(); 
			$('#picture_photo').uploadifyUpload(); 
		});
		
}); 
</script>

